# Demonstrates scoring G-values with chemistry g4em-dna-chemistry. 
# An electron point source of 80 keV is shot from the center of 
# a large water volume. Similar to chem5 Geant4-DNA example 
# and Kyriakou et al., 2022
#
# Restrictions: 
# *  Only one GValue scorer is allowed 
# *  The time limit is up to 1 microsecond. 
# *  The media must be G4_WATER 
# *  NO PARALLEL volumes are supported.
# *  Due to the name of the molecule scored, BINARY output
#    is not supported, only ROOT and ASCII 
# 

i:Ts/NumberOfThreads = 4
sv:Ph/Default/Modules = 2 "g4em-dna" "g4em-dna-chemistry"
b:Ch/Default/ChemicalStageTransportActive = "True"

d:Ge/World/HLX= 100 cm
d:Ge/World/HLY= 100 cm
d:Ge/World/HLZ= 100 cm
s:Ge/World/Material ="G4_WATER"

d:Ge/Target/HLX= Ge/World/HLX cm 
d:Ge/Target/HLY= Ge/World/HLY cm
d:Ge/Target/HLZ= Ge/World/HLZ cm 
s:Ge/Target/Material = "G4_WATER"
s:Ge/Target/Type     = "TsBox"
s:Ge/Target/Parent   = "World"

Ge/BeamPosition/TransZ = 0 um
Ge/BeamPosition/RotX = 0 deg

So/Demo/BeamPositionDistribution = "None"
So/Demo/BeamEnergySpread = 0
So/Demo/BeamParticle = "e-"
So/Demo/BeamEnergy   = 80 keV
i:So/Demo/NumberOfHistoriesInRun = 100

s:Sc/GValueInTarget/Quantity = "TsSBSGValue" 
s:Sc/GValueInTarget/Component = "Target"
d:Sc/GValueInTarget/KillPrimaryIfEnergyLossExceeds = 1 keV
s:Sc/GValueInTarget/IfOutputFileAlreadyExists      = "Overwrite"
b:Sc/GValueInTarget/KillPrimaryBasedOnEnergyLoss   = "true"
d:Sc/GValueInTarget/KillPrimaryBasedOnTrackLength  = 100 km 
d:Sc/GValueInTarget/AbortEventIfPrimaryEnergyLossExceeds = 2 keV
# Record time, do not confuse with Time features.
s:Sc/GValueInTarget/OutputType = "ascii" # or root
s:Sc/GValueInTarget/OutputFile = "Gvalue_e_80keV"
dv:Sc/GValueInTarget/TimeToRecord = 20 1.00000e0 2.06913e0 4.28133e0 8.85866e0
                                       1.83298e1 3.79268e1 7.84759e1 1.62377e2
                                       3.35981e2 6.95192e2 1.43844e3 2.97634e3
                                       6.15847e3 1.27427e4 2.63664e4 5.45559e4
                                       1.12883e5 2.33571e5 4.83292e5 9.99999e5 ps

i:Ts/ShowHistoryCountAtInterval = 10 
b:Ts/ShowCPUTime = "True"
i:Ts/Seed = 12345

# s:Gr/ViewA/Type        = "OpenGL"
# b:Ts/PauseBeforeQuit   = "True"
# Ts/UseQt = "True"
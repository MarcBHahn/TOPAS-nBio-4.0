################# TOPAS #################

i:Ts/ShowHistoryCountAtInterval = 50000
i:Ts/MaxInterruptedHistories  = So/Demo/NumberOfHistoriesInRun
Ts/NumberOfThreads = 0
b:Ts/ShowCPUTime = "True"

################# CHEMISTRY #################

sv:Ph/Default/Modules = 2 "TsEmDNAPhysics" "TsEmDNAChemistry"
s:Ph/Default/Electron/SetElasticScatteringModel  = "ELSEPA" 
s:Ph/Default/SolvatedElectronThermalizationModel =  "Meesungnoen" 

s:Ch/ChemistryName = "TOPASChemistry"
b:Ch/TOPASChemistry/ChemicalStageTransportActive = "True"
d:Ch/TOPASChemistry/ChemicalStageTimeEnd    = 1.00001 us
b:Ch/TOPASChemistry/TestForContactReactions = "True"

includeFile = TOPASDNAReactions.txt

################# IRT Molecules #################

s:Mo/DMSO/Symbol = "DMSO"
d:Mo/DMSO/DiffusionCoefficient = 0 nm2/s
u:Mo/DMSO/Charge = 0
d:Mo/DMSO/Radius = 0.3 nm

s:Mo/OHDMSOProduct/Symbol = "OHDMSOProduct"
d:Mo/OHDMSOProduct/DiffusionCoefficient = 0 nm2/s
u:Mo/OHDMSOProduct/Charge = 0
d:Mo/OHDMSOProduct/Radius = 0.3 nm

s:Mo/HDMSOProduct/Symbol = "HDMSOProduct"
d:Mo/HDMSOProduct/DiffusionCoefficient = 0 nm2/s
u:Mo/HDMSOProduct/Charge = 0
d:Mo/HDMSOProduct/Radius = 0.3 nm

d:Ch/TOPASChemistry/Reaction/Hydroxyl/Deoxyribose/ReactionRate = fOHDNAKobs /M/s

sv:Ch/TOPASChemistry/BackgroundReaction/hydroxyl/DMSO/Products = 1 "OHDMSOProduct"
d:Ch/TOPASChemistry/BackgroundReaction/hydroxyl/DMSO/ReactionRate = 7.1e9 /M/s
d:Ch/TOPASChemistry/BackgroundReaction/hydroxyl/DMSO/Concentration = fDMSOConcentration M 
b:Ch/TOPASChemistry/BackgroundReaction/hydroxyl/DMSO/CompatibleWithStepByStep = "False" 

sv:Ch/TOPASChemistry/BackgroundReaction/hydrogen/DMSO/Products = 1 "HDMSOProduct"
d:Ch/TOPASChemistry/BackgroundReaction/hydrogen/DMSO/ReactionRate = 2.7e6 /M/s
d:Ch/TOPASChemistry/BackgroundReaction/hydrogen/DMSO/Concentration = fDMSOConcentration M 
b:Ch/TOPASChemistry/BackgroundReaction/hydrogen/DMSO/CompatibleWithStepByStep = "False" 

sv:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/DMSO/Products = 1 "HDMSOProduct"
d:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/DMSO/ReactionRate = 3.8e6 /M/s
d:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/DMSO/Concentration = fDMSOConcentration M 
b:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/DMSO/CompatibleWithStepByStep = "False" 

# O2
sv:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/Oxygen/Products = 1 "SuperoxideAnion"
d:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/Oxygen/ReactionRate = 1.9e10 /M/s
d:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/Oxygen/Concentration = 0.27e-3 M # 21 perCent 
i:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/Oxygen/ReactionType = 6
b:Ch/TOPASChemistry/BackgroundReaction/SolvatedElectron/Oxygen/CompatibleWithStepByStep = "False"

sv:Ch/TOPASChemistry/BackgroundReaction/Hydrogen/Oxygen/Products = 1 "hydroperoxy" 
d:Ch/TOPASChemistry/BackgroundReaction/Hydrogen/Oxygen/ReactionRate = 2.1e10 /M/s
d:Ch/TOPASChemistry/BackgroundReaction/Hydrogen/Oxygen/Concentration = 0.27e-3 M # 21 perCent 
i:Ch/TOPASChemistry/BackgroundReaction/Hydrogen/Oxygen/ReactionType = 6
b:Ch/TOPASChemistry/BackgroundReaction/Hydrogen/Oxygen/CompatibleWithStepByStep = "False"


################# Geometry #################

Ge/World/HLX= 1.0 um 
Ge/World/HLY= 1.0 um 
Ge/World/HLZ= 1.0 um 
Ge/World/Material ="G4_WATER"

################# Plasmid #################

s:Ge/Plasmids/Type             = "TsIRTPlasmidSupercoiled"
s:Ge/Plasmids/Parent           = "World"
s:Ge/Plasmids/Material         = "G4_WATER"
i:Ge/Plasmids/NumberOfPlasmids = 5
d:Ge/Plasmids/R                = 0.5 um
s:Ge/Plasmids/InputFile        = "pUC19_20C_6_1.xyz"
s:Ge/Plasmids/EnvelopeFileName = "Plasmid_50ugg_Sphere_1um_diameter_envelopes.xyz"

includeFile = pUC19_20C_3Sigma_ALP_Properties.txt

################# Source #################

s:So/Demo/Type             = "VolumeOrSurface"
s:So/Demo/Component        = "Plasmids" 
s:So/Demo/BeamParticle     = "e-"
s:So/Demo/BeamPositionDistribution = "None"
i:So/Demo/NumberOfHistoriesInRun   = 500000
i:So/Demo/NumberOfHistoriesInEvent = 1
d:So/Demo/BeamEnergy = 250 keV 
u:So/Demo/BeamEnergySpread = 0
s:So/Demo/DistributePrimariesAtVolumeRegion = "Volume"
s:So/Demo/DirectPrimariesTo = "Isotropic"

#s:So/Demo/BeamEnergySpectrumType = "Discrete"
#dv:So/Demo/BeamEnergySpectrumValues = 19 0.0144 0.0432 0.0720 
#                                         0.1008 0.1296 0.1584 
#                                         0.1872 0.2160 0.2448
#                                         0.2736 0.3024 0.3312
#                                         0.3600 0.3888 0.4176
#                                         0.4464 0.4752 0.5040 0.5328 MeV
#uv:So/Demo/BeamEnergySpectrumWeights = 19 0.030134946933679106 0.041924794698170294 0.04768765307592566 
#                                          0.052586082697017720 0.055155357057100320 0.05568361907506123
#                                          0.056812178840704990 0.057220381309129330 0.05837295298468040
#                                          0.056043797723670940 0.053954761561734620 0.05229793977812995 
#                                          0.049704653508140040 0.042861259184555536 0.03522547183402968 
#                                          0.208903616193632040 0.045382509724823515 2.4011909907314027e-05 
#                                          2.4011909907314027e-05 


################# Scorer #################

#b:Sc/nbOfMol/IRTHomogeneous = "True"
#b:Ch/TOPASChemistry/Reaction/Hydroxyl/Deoxyribose/HomogeneousCompatible = "False"
#b:Ch/TOPASChemistry/Reaction/Hydrogen/Deoxyribose/HomogeneousCompatible = "False"
#b:Ch/TOPASChemistry/Reaction/SolvatedElectron/Deoxyribose/HomogeneousCompatible = "False"

s:Sc/nbOfMol/Quantity                  = "TsIRTStrandBreaksPulsed"
s:Sc/nbOfMol/Component                 = "Plasmids"
i:Sc/nbOfMol/OutputBufferSize          = 1 
d:Sc/nbOfMol/TimeLower                 = 1.0 ps
#d:Sc/nbOfMol/TimeUpper                 = 350 s #20 us #0.1   ms
#d:Sc/nbOfMol/PulseSimulationTime       = 350 s #20 us #0.1   ms 
i:Sc/nbOfMol/TimeBins                  = 400

# Pulse Configuration
s:Sc/nbOfMol/PulseDistribution = "uniform" 
#d:Sc/nbOfMol/PulseTimeMean     = 0.99 us #0.5 us 
#d:Sc/nbOfMol/PulseTimeFWHM     = 1.98 us #1 us 
#i:Sc/nbOfMol/NumberOfPulses    = 1 #fNbOfPulses 
d:Sc/nbOfMol/PulsesFrequency   = 100 /s #10 /s #1e6 /s #100 /s

# Boolean Configuration of Scorer
b:Sc/nbOfMol/EnableHighTimeScavengers = "True"
b:Sc/nbOfMol/ForceLowTimeCutTo1ps     = "False"
b:Sc/nbOfMol/PropagateToChildren      = "True"
b:Sc/nbOfMol/ReportMoleculeYield      = "True"
b:Sc/nbOfMol/SavePulseInformation     = "True"
b:Sc/nbOfMol/ReportAtEachHistory      = "False"
b:Sc/nbOfMol/RecyclePulses            = "False"

# Output Options
i:Sc/nbOfMol/NumberOfRepetitions = fNumberOfRepeats 
s:Sc/nbOfMol/OutputFile          = "IRT_GValue_fDMSOConcentration"
s:Sc/nbOfMol/OutputType          = "ASCII"
s:Sc/nbOfMol/IfOutputFileAlreadyExists = "Overwrite"

# DNA Molecules to insert and Check
sv:Sc/nbOfMol/DNAMoleculesNames   = 1 "Deoxyribose"
uv:Sc/nbOfMol/DNAMoleculesWeights = 1 1.0

sv:Sc/nbOfMol/StrandBreakMolecules = 3 "OHDeoxyriboseDamaged" "HDeoxyriboseDamaged" "EDeoxyriboseDamaged"

#s:Sc/RootFileName = Sc/nbOfMol/OutputFile

################# Visualization #################

#s:Gr/ViewA/Type        = "OpenGL"
#i:Gr/ViewA/WindowSizeX = 768
#i:Gr/ViewA/WindowSizeY = 768
#d:Gr/ViewA/Theta       = 90 deg
#d:Gr/ViewA/Phi         = 90 deg
#u:Gr/ViewA/Zoom        = 4
#b:Ts/PauseBeforeQuit   = "True"

###########################################
Ts/Seed = 27669
d:Sc/nbOfMol/PrescribedDose = 20 Gy
i:Sc/nbOfMol/NumberOfPulses = 1
d:Sc/nbOfMol/TimeUpper = 5 s
d:Sc/nbOfMol/PulseSimulationTime = 5 s
d:Sc/nbOfMol/PulseTimeMean = 2 s
d:Sc/nbOfMol/PulseTimeFWHM = 4 s
